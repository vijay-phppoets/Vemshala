{"ast":null,"code":"import _defineProperty from\"/home/coder-kabir/Documents/GitHub/Vemshala/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/coder-kabir/Documents/GitHub/Vemshala/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/coder-kabir/Documents/GitHub/Vemshala/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button,Pagination,Space,Spin}from\"antd\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import{Link,Redirect,useLocation}from\"react-router-dom\";/* custom components */import FilterSection from\"../../component/FilterSection/FilterSection\";import Product from\"../../component/Product/Product\";import{GlobleBox,Wrapper}from\"../../component/Xcomponent\";import{ProductsBox,ProductsWrapper}from\"./ProductListStyle\";/* actions */import{getProductList as _getProductList,getProductListReset as _getProductListReset}from\"../../action/getProductListAction\";/* other */import{getCurrency}from\"../../utils\";var ProductList=function ProductList(props){/* variables */var getProductList=props.getProductList,getProductListReset=props.getProductListReset,getProductListState=props.getProductListState;var search=useLocation().search;var page=new URLSearchParams(search).get(\"page\");var sort=new URLSearchParams(search).get(\"sort\");var filter=new URLSearchParams(search).get(\"filter\");var attr_filter=new URLSearchParams(search).get(\"attr_filter\");var _useState=useState({page:page?parseInt(page):1,records:20}),_useState2=_slicedToArray(_useState,2),pagination=_useState2[0],setPagination=_useState2[1];var _useState3=useState(sort?sort:\"\"),_useState4=_slicedToArray(_useState3,2),sortBy=_useState4[0],setSortBy=_useState4[1];var _useState5=useState([false,\"\"]),_useState6=_slicedToArray(_useState5,2),redirect=_useState6[0],setRedirect=_useState6[1];var _useState7=useState(filter?JSON.parse(filter):{}),_useState8=_slicedToArray(_useState7,2),filter_params=_useState8[0],set_filter_params=_useState8[1];var _useState9=useState(attr_filter?JSON.parse(attr_filter):{}),_useState10=_slicedToArray(_useState9,2),attr_filter_params=_useState10[0],set_attr_filter_params=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),currencyType=_useState12[0],setCurrencyType=_useState12[1];/* callbacks */useEffect(function(){var currency=getCurrency();setCurrencyType(currency);if(!props.forSearch){getProductList({category_url_key:props.category_url_key,page:pagination.page,records:pagination.records,sort_key:sortBy,filter_params:filter_params,attr_filter_params:attr_filter_params,currencyType:currency});}else{getProductList({page:pagination.page,records:pagination.records,search_query:props.search_query,filter_params:{},attr_filter_params:{},currencyType:currency});}},[pagination,sortBy,filter_params,attr_filter_params,props.search_query]);useEffect(function(){var url=\"\";if(props.forSearch){url=\"/search/\".concat(props.search_query,\"?page=\").concat(pagination.page);}else{url=\"/shop/\".concat(props.category_url_key,\"?page=\").concat(pagination.page);}if(sortBy)url=\"/shop/\".concat(props.category_url_key,\"?page=\").concat(pagination.page,\"&sort=\").concat(sortBy);var filter_params_keys=Object.keys(filter_params);if(filter_params_keys.length>0){url=\"\".concat(url,\"&filter=\").concat(JSON.stringify(filter_params));}var attr_filter_params_keys=Object.keys(attr_filter_params);if(attr_filter_params_keys.length>0){url=\"\".concat(url,\"&attr_filter=\").concat(JSON.stringify(attr_filter_params));}setRedirect([true,url]);},[pagination,sortBy,filter_params,attr_filter_params]);/* functions */var handleSort=function handleSort(sort_key){setSortBy(sort_key);};var handleFilter=function handleFilter(filter_by,filter_value,checked){var values=filter_params[filter_by];var valuesArr=values?values.split(\",\"):[];if(checked){valuesArr.push(filter_value);set_filter_params(_objectSpread(_objectSpread({},filter_params),{},_defineProperty({},filter_by,valuesArr.join(\",\"))));}else{valuesArr=valuesArr.filter(function(el){return el!==filter_value;});if(valuesArr.length>0)set_filter_params(_objectSpread(_objectSpread({},filter_params),{},_defineProperty({},filter_by,valuesArr.join(\",\"))));else{delete filter_params[filter_by];set_filter_params(_objectSpread({},filter_params));}}};var handleAttrFilter=function handleAttrFilter(filter_by,filter_value,checked){var values=attr_filter_params[filter_by];var valuesArr=values?values.split(\",\"):[];if(checked){valuesArr.push(filter_value);set_attr_filter_params(_objectSpread(_objectSpread({},attr_filter_params),{},_defineProperty({},filter_by,valuesArr.join(\",\"))));}else{valuesArr=valuesArr.filter(function(el){return el!==filter_value;});if(valuesArr.length>0)set_attr_filter_params(_objectSpread(_objectSpread({},attr_filter_params),{},_defineProperty({},filter_by,valuesArr.join(\",\"))));else{delete attr_filter_params[filter_by];set_attr_filter_params(_objectSpread({},attr_filter_params));}}};return/*#__PURE__*/React.createElement(React.Fragment,null,redirect[0]&&/*#__PURE__*/React.createElement(Redirect,{to:redirect[1]}),/*#__PURE__*/React.createElement(GlobleBox,null,/*#__PURE__*/React.createElement(Wrapper,null,!props.forSearch&&/*#__PURE__*/React.createElement(FilterSection,{handleSort:handleSort,handleFilter:handleFilter,handleAttrFilter:handleAttrFilter,category_url_key:props.category_url_key,filter_params:filter_params,attr_filter_params:attr_filter_params,sortBy:sortBy}),props.search_query&&/*#__PURE__*/React.createElement(\"h2\",{style:{textAlign:\"center\"}},\"Search Result: '\",props.search_query,\"'\"),getProductListState.list.length>0&&/*#__PURE__*/React.createElement(Spin,{spinning:getProductListState.apiState===\"loading\",tip:\"Loading...\",size:\"large\"},/*#__PURE__*/React.createElement(ProductsWrapper,null,getProductListState.list.map(function(product){return/*#__PURE__*/React.createElement(ProductsBox,{className:\"desktop\"},/*#__PURE__*/React.createElement(Product,{product:product,hideActionBtns:props.hideActionBtns,currencyType:currencyType}));})),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",justifyContent:\"center\",marginBottom:64}},/*#__PURE__*/React.createElement(Pagination,{current:pagination.page,total:getProductListState.total_records,pageSize:pagination.records,onChange:function onChange(page,pageSize){return setPagination(_objectSpread(_objectSpread({},pagination),{},_defineProperty({},\"page\",page)));}}))),getProductListState.apiState===\"success\"&&getProductListState.list.length===0&&/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",flexDirection:\"column\",alignItems:\"center\",minHeight:300,justifyContent:\"center\"}},/*#__PURE__*/React.createElement(\"h3\",null,\"No Product Found.\"),/*#__PURE__*/React.createElement(Space,null,/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){set_filter_params({});set_attr_filter_params({});}},\"Clear Filter\"),/*#__PURE__*/React.createElement(Link,{to:\"/\"},/*#__PURE__*/React.createElement(Button,null,\"Home\")))),getProductListState.apiState===\"error\"&&/*#__PURE__*/React.createElement(\"h1\",null,\"Error\"))));};var mapStateToProps=function mapStateToProps(state){return{getProductListState:state.getProductList};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{getProductList:function getProductList(params){return dispatch(_getProductList(params));},getProductListReset:function getProductListReset(){return dispatch(_getProductListReset());}};};export default connect(mapStateToProps,mapDispatchToProps)(ProductList);","map":{"version":3,"sources":["/home/coder-kabir/Documents/GitHub/Vemshala/src/component/ProductList/ProductList.js"],"names":["Button","Pagination","Space","Spin","React","useEffect","useState","connect","Link","Redirect","useLocation","FilterSection","Product","GlobleBox","Wrapper","ProductsBox","ProductsWrapper","getProductList","getProductListReset","getCurrency","ProductList","props","getProductListState","search","page","URLSearchParams","get","sort","filter","attr_filter","parseInt","records","pagination","setPagination","sortBy","setSortBy","redirect","setRedirect","JSON","parse","filter_params","set_filter_params","attr_filter_params","set_attr_filter_params","currencyType","setCurrencyType","currency","forSearch","category_url_key","sort_key","search_query","url","filter_params_keys","Object","keys","length","stringify","attr_filter_params_keys","handleSort","handleFilter","filter_by","filter_value","checked","values","valuesArr","split","push","join","el","handleAttrFilter","textAlign","list","apiState","map","product","hideActionBtns","display","justifyContent","marginBottom","total_records","pageSize","flexDirection","alignItems","minHeight","mapStateToProps","state","mapDispatchToProps","dispatch","params"],"mappings":"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","sourcesContent":["import { Button, Pagination, Space, Spin } from \"antd\";\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Link, Redirect, useLocation } from \"react-router-dom\";\n\n/* custom components */\nimport FilterSection from \"../../component/FilterSection/FilterSection\";\nimport Product from \"../../component/Product/Product\";\nimport { GlobleBox, Wrapper } from \"../../component/Xcomponent\";\nimport { ProductsBox, ProductsWrapper } from \"./ProductListStyle\";\n\n/* actions */\nimport {\n  getProductList,\n  getProductListReset,\n} from \"../../action/getProductListAction\";\n\n/* other */\nimport { getCurrency } from \"../../utils\";\n\nconst ProductList = (props) => {\n  /* variables */\n  const { getProductList, getProductListReset, getProductListState } = props;\n  const search = useLocation().search;\n  const page = new URLSearchParams(search).get(\"page\");\n  const sort = new URLSearchParams(search).get(\"sort\");\n  const filter = new URLSearchParams(search).get(\"filter\");\n  const attr_filter = new URLSearchParams(search).get(\"attr_filter\");\n  const [pagination, setPagination] = useState({\n    page: page ? parseInt(page) : 1,\n    records: 20,\n  });\n  const [sortBy, setSortBy] = useState(sort ? sort : \"\");\n  const [redirect, setRedirect] = useState([false, \"\"]);\n  const [filter_params, set_filter_params] = useState(\n    filter ? JSON.parse(filter) : {}\n  );\n  const [attr_filter_params, set_attr_filter_params] = useState(\n    attr_filter ? JSON.parse(attr_filter) : {}\n  );\n  const [currencyType, setCurrencyType] = useState(\"\");\n\n  /* callbacks */\n  useEffect(() => {\n    let currency = getCurrency();\n    setCurrencyType(currency);\n    if (!props.forSearch) {\n      getProductList({\n        category_url_key: props.category_url_key,\n        page: pagination.page,\n        records: pagination.records,\n        sort_key: sortBy,\n        filter_params: filter_params,\n        attr_filter_params: attr_filter_params,\n        currencyType: currency,\n      });\n    } else {\n      getProductList({\n        page: pagination.page,\n        records: pagination.records,\n        search_query: props.search_query,\n        filter_params: {},\n        attr_filter_params: {},\n        currencyType: currency,\n      });\n    }\n  }, [\n    pagination,\n    sortBy,\n    filter_params,\n    attr_filter_params,\n    props.search_query,\n  ]);\n\n  useEffect(() => {\n    let url = \"\";\n    if (props.forSearch) {\n      url = `/search/${props.search_query}?page=${pagination.page}`;\n    } else {\n      url = `/shop/${props.category_url_key}?page=${pagination.page}`;\n    }\n    if (sortBy)\n      url = `/shop/${props.category_url_key}?page=${pagination.page}&sort=${sortBy}`;\n\n    const filter_params_keys = Object.keys(filter_params);\n    if (filter_params_keys.length > 0) {\n      url = `${url}&filter=${JSON.stringify(filter_params)}`;\n    }\n\n    const attr_filter_params_keys = Object.keys(attr_filter_params);\n    if (attr_filter_params_keys.length > 0) {\n      url = `${url}&attr_filter=${JSON.stringify(attr_filter_params)}`;\n    }\n\n    setRedirect([true, url]);\n  }, [pagination, sortBy, filter_params, attr_filter_params]);\n\n  /* functions */\n  const handleSort = (sort_key) => {\n    setSortBy(sort_key);\n  };\n\n  const handleFilter = (filter_by, filter_value, checked) => {\n    let values = filter_params[filter_by];\n    let valuesArr = values ? values.split(\",\") : [];\n\n    if (checked) {\n      valuesArr.push(filter_value);\n      set_filter_params({ ...filter_params, [filter_by]: valuesArr.join(\",\") });\n    } else {\n      valuesArr = valuesArr.filter((el) => el !== filter_value);\n      if (valuesArr.length > 0)\n        set_filter_params({\n          ...filter_params,\n          [filter_by]: valuesArr.join(\",\"),\n        });\n      else {\n        delete filter_params[filter_by];\n        set_filter_params({ ...filter_params });\n      }\n    }\n  };\n\n  const handleAttrFilter = (filter_by, filter_value, checked) => {\n    let values = attr_filter_params[filter_by];\n    let valuesArr = values ? values.split(\",\") : [];\n\n    if (checked) {\n      valuesArr.push(filter_value);\n      set_attr_filter_params({\n        ...attr_filter_params,\n        [filter_by]: valuesArr.join(\",\"),\n      });\n    } else {\n      valuesArr = valuesArr.filter((el) => el !== filter_value);\n      if (valuesArr.length > 0)\n        set_attr_filter_params({\n          ...attr_filter_params,\n          [filter_by]: valuesArr.join(\",\"),\n        });\n      else {\n        delete attr_filter_params[filter_by];\n        set_attr_filter_params({ ...attr_filter_params });\n      }\n    }\n  };\n\n  return (\n    <>\n      {redirect[0] && <Redirect to={redirect[1]} />}\n\n      <GlobleBox>\n        <Wrapper>\n          {!props.forSearch && (\n            <FilterSection\n              handleSort={handleSort}\n              handleFilter={handleFilter}\n              handleAttrFilter={handleAttrFilter}\n              category_url_key={props.category_url_key}\n              filter_params={filter_params}\n              attr_filter_params={attr_filter_params}\n              sortBy={sortBy}\n            />\n          )}\n          {props.search_query && (\n            <h2 style={{ textAlign: \"center\" }}>\n              Search Result: '{props.search_query}'\n            </h2>\n          )}\n          {getProductListState.list.length > 0 && (\n            <Spin\n              spinning={getProductListState.apiState === \"loading\"}\n              tip=\"Loading...\"\n              size=\"large\"\n            >\n              <ProductsWrapper>\n                {getProductListState.list.map((product) => (\n                  <ProductsBox className=\"desktop\">\n                    <Product\n                      product={product}\n                      hideActionBtns={props.hideActionBtns}\n                      currencyType={currencyType}\n                    />\n                  </ProductsBox>\n                ))}\n              </ProductsWrapper>\n              <div\n                style={{\n                  display: \"flex\",\n                  justifyContent: \"center\",\n                  marginBottom: 64,\n                }}\n              >\n                <Pagination\n                  current={pagination.page}\n                  total={getProductListState.total_records}\n                  pageSize={pagination.records}\n                  onChange={(page, pageSize) =>\n                    setPagination({ ...pagination, [\"page\"]: page })\n                  }\n                />\n              </div>\n            </Spin>\n          )}\n\n          {getProductListState.apiState === \"success\" &&\n            getProductListState.list.length === 0 && (\n              <div\n                style={{\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  alignItems: \"center\",\n                  minHeight: 300,\n                  justifyContent: \"center\",\n                }}\n              >\n                <h3>No Product Found.</h3>\n                <Space>\n                  <Button\n                    onClick={() => {\n                      set_filter_params({});\n                      set_attr_filter_params({});\n                    }}\n                  >\n                    Clear Filter\n                  </Button>\n                  <Link to=\"/\">\n                    <Button>Home</Button>\n                  </Link>\n                </Space>\n              </div>\n            )}\n\n          {getProductListState.apiState === \"error\" && <h1>Error</h1>}\n        </Wrapper>\n      </GlobleBox>\n    </>\n  );\n};\n\nconst mapStateToProps = (state) => ({\n  getProductListState: state.getProductList,\n});\nconst mapDispatchToProps = (dispatch) => ({\n  getProductList: (params) => dispatch(getProductList(params)),\n  getProductListReset: () => dispatch(getProductListReset()),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductList);\n"]},"metadata":{},"sourceType":"module"}